"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7570],{7570:function(e,l,t){t.d(l,{d:function(){return CIBSelect}});var c=t(5311),i=t(6840),a=t(7444);function CIBOptions(e){let{data:l,selected:t,parentProps:a,itemProps:n,level:o=0}=e,{name:r,label:s,placeholder:d,value:b,options:u,required:p,errorText:f,multiple:m,onSelect:h,onClearSelection:v,tree:x,sortBy:g,noMobile:w,skipSort:y}=a,j=(0,i.useRef)([]),[k,N]=(0,i.useState)(l),[S,E]=(0,i.useState)(!1),C=(0,i.useCallback)(e=>{let l=e.target;e.detail[0],("input"===e.target.tagName.toLowerCase()||"li"===e.target.tagName.toLowerCase()||"label"===e.target.tagName.toLowerCase())&&(l=e.target.closest("cib-checkbox"));let t=null;l&&(t=k[l.getAttribute("data-item-key")]),void 0!==h&&h(e,t)},[h,k]),z=(0,i.useCallback)(e=>{if(g){let l=Object.values(e);if(l.length>0&&void 0!==l[0][g])return l.sort((e,l)=>e[g]>l[g]?1:-1),Object.assign({},l)}return e},[g]),O=(0,i.useCallback)(e=>{var l;let t=Object.values(e);if(t.length>0&&(null===(l=t[0])||void 0===l?void 0:l.weight)!==void 0)return t.sort((e,l)=>(null==e?void 0:e.weight)>(null==l?void 0:l.weight)?1:-1),Object.assign({},t)},[]),I=(0,i.useCallback)(e=>{let moveToNextElement=l=>{e.preventDefault();let t=e.target.closest("form").querySelectorAll("[tabindex]:not(.cib-select-cib-checkbox-label),input,textarea,button,submit"),c=e.target.closest(".cib-select-wrapper");if(c){let e=Array.prototype.slice.call(t).filter(e=>{let l=e.closest(".cib-select-wrapper");return!l||!!e.classList.contains("cib-select-wrapper")}),i=Array.prototype.indexOf.call(e,c);e[i+l].focus()}};"Enter"===e.code&&(e.target.click(),moveToNextElement(1)),"Escape"===e.code&&moveToNextElement(0)},[]);return(0,i.useEffect)(()=>{let e=null==j?void 0:j.current;if(null==e||e.forEach(e=>{if(!e||(null==e||e.addEventListener("update:checked",C),m))return;let l=null==e?void 0:e.querySelector("label"),t=null==e?void 0:e.querySelector("input");l&&t&&(l.setAttribute("tabindex",0),l.setAttribute("for",t.getAttribute("id")),l.classList.add("cib-select-cib-checkbox-label"),l.addEventListener("keydown",I))}),!S){let e=y?O(k):z(k);N(e),E(!0)}return function(){null==e||e.forEach(e=>{if(!e||(null==e||e.removeEventListener("update:checked",C),m))return;let l=null==e?void 0:e.querySelector("label"),t=null==e?void 0:e.querySelector("input");l&&t&&l.removeEventListener("keydown",I)})}},[C,I,j,z,O,k,S,y,m]),(0,c.jsx)(c.Fragment,{children:Object.keys(k).map((e,l)=>{let i=k[e],s=t,d=(null==i?void 0:i.prettyValue)||(null==i?void 0:i.value);if(m){if(null!=b&&b.length>0){let e=b.find(e=>e.toString()===d.toString());null!=e&&e.length>0&&(s=!0)}}else s=b===d.toString();return(0,c.jsxs)("li",{role:"option","aria-label":i.label,className:"cib-select-li cib-text-primary cib-flex !h-auto flex-wrap","aria-checked":s,"aria-selected":s,children:[(0,c.jsx)("cib-checkbox",{value:i.value.toString(),class:"cib-custom-element-class cib-font-open-sans ".concat(w?"py-1.5 pr-2 ".concat(o<=0?"pl-2":"pl-6"):"py-2.75 pr-0 ".concat(o<=0?"pl-0":"pl-4")," lg:py-1.5 ").concat(m?"":"hide-input"," lg:pr-2 ").concat(o<=0?"lg:pl-2":"lg:pl-6"),checked:s,name:"".concat(r,"--option--").concat(i.value),label:i.label,"data-item-key":e,...n,ref:e=>{j.current[l]=e},role:"checkbox"},"".concat(r,"---").concat(i.value,"--option")),Object.keys(i.children).length>0&&(0,c.jsx)("ul",{role:"listbox",className:"cib-select-ul-dropdown cib-flex cib-flex-col cib-w-full cib-rounded-t-m",children:(0,c.jsx)(CIBOptions,{selected:s,data:i.children,parentProps:a,itemProps:n,level:o+1})})]},"".concat(r,"--").concat(i.value,"--fragment"))})})}function CIBSelect(e){var l,t;let{t:n}=(0,a.$G)("common"),{name:o,label:r,placeholder:s,value:d,options:b,required:u,showRequired:p,errorText:f,multiple:m,onSelect:h,onClearSelection:v,onDropdownShown:x,onDropdownHidden:g,tree:w,sortBy:y,fullWidth:j,inputProps:k,listProps:N,listItemProps:S={},deleteButtonProps:E,openButtonProps:C,attributes:z={},disabled:O,noMobile:I}=e,[L,q]=(0,i.useState)(!1),[A,_]=(0,i.useState)(null),T=i.createRef(),[B,P]=(0,i.useState)(d),V=(0,i.useCallback)(e=>{T.current&&!T.current.contains(e.target)&&L&&q(!1),!T.current&&null===e.target.closest(".cib-custom-element-class")&&L&&q(!1)},[T,L]);(0,i.useEffect)(()=>{if(null===A){let e=b.filter((e,l)=>{let t=!1,c=(null==e?void 0:e.prettyValue)||(null==e?void 0:e.value);if(m){if(null!=d&&d.length>0){let e=d.find(e=>e.toString()===c.toString());null!=e&&e.length>0&&(t=!0)}}else t=d===c.toString();return t});_([...e])}return document.addEventListener("mousedown",V),function(){document.removeEventListener("mousedown",V)}},[m,L,V,b,A,d]);let handleSelectedItemSelect=(l,t)=>{let c=[...A];if(m){if(l.target.closest(".cib-select-li")&&l.target.closest(".cib-select-li").nextSibling){let e=l.target.closest(".cib-select-li").nextSibling.querySelector('[tabindex="0"]');e&&e.focus()}else{let e=l.target.closest(".cib-select-dropdown").querySelectorAll('.cib-select-ul-dropdown-options .cib-select-li [tabindex="0"]');e&&e.length>0&&e[0].focus()}let i=c.findIndex(e=>e.value===t.value);i<0?c.push(t):c.splice(i,1);let a=[];c.forEach(e=>{a.push(e.value)}),P([...a]),_([...c]),void 0!==h&&h(l,{elementProps:e,item:t,selected:!1,items:[...c]})}},F={};if(b.forEach((e,l)=>{F[null==e?void 0:e.value]={children:{},weight:l,...e}}),w){let buildTree=(e,l)=>{Object.keys(l).forEach(t=>{let c=l[t];null!=e?void 0!==c.parentValue&&null!==c.parentValue&&c.parentValue.toString()===e.toString()&&(l[e].children[c.value]=c):buildTree(c.value,l)})};buildTree(void 0,F),(e=>{Object.keys(e).forEach(l=>{let t=e[l];void 0!==t.parentValue&&null!==t.parentValue&&delete e[l]})})(F)}L?void 0!==x&&x(e):void 0!==g&&g(e);let R={};(null==k?void 0:k.id)&&(R.htmlFor=k.id);let D=null,handleClearClick=(e,l)=>{v&&v(e,l),P([]),_([])};return z["aria-expanded"]=L,(0,c.jsx)("div",{className:"cib-select-react cib-custom-element-class cib-font-open-sans ".concat(j?"cib-w-full":""),...z,children:(0,c.jsxs)("div",{className:"cib-select-container cib-first-letter-capitalized cib-min-w relative",ref:T,children:[(0,c.jsxs)("div",{className:"cib-flex cib-justify-between pb-1 cib-items-end ".concat(r?"".concat(I?"pt-0 static z-0 border-0":"sticky pt-4.5 top-0 z-10 border-b"," lg:pt-0 lg:static lg:z-0 lg:border-0 cib-border-default cib-bg-surface"):""),children:[r&&(0,c.jsx)("label",{className:"cib-font-semibold cib-first-letter-capitalized cib-h-6 cib-text-major ".concat(I?"normal-case":"uppercase"," lg:normal-case"),...R,onClick:e=>{let l=e.target.getAttribute("for");if(l){let e=document.getElementById(l);e&&e.focus()}},id:"".concat(null==k?void 0:k.id,"-label"),children:r}),(!u||u&&p)&&(0,c.jsx)("div",{className:"cib-main-font-body-s-regular cib-ml-2 cib-pb-1",children:(0,c.jsx)("span",{className:"".concat(u?"cib-text-required":"cib-text-minor"),children:n(u?"Required":"Optional")})})]}),(0,c.jsxs)("div",{className:"cib-select-wrapper relative w-full group rounded focus-visible:outline focus-visible:outline-2 focus-visible:outline-focused focus-visible:outline-offset-1 dark:focus-visible:outline-dark-focused",role:"combobox","aria-labelledby":"".concat(null==k?void 0:k.id,"-label"),"aria-controls":"".concat(null==k?void 0:k.id,"-controls"),"aria-expanded":L,...k,tabIndex:0,onFocus:()=>{q(!0),clearTimeout(D)},onBlur:()=>{D=setTimeout(()=>{q(!1)})},children:[(0,c.jsxs)("div",{className:"cib-select cib-border-default cib-border ".concat(f?"cib-border-danger":"focus-within:cib-border focus-within:cib-border-activated"," ").concat(O?"cib-bg-gray-300":"cib-bg-surface"," cib-rounded-xs ").concat(I?"flex":"hidden"," lg:flex justify-between h-8 items-center"),children:[!m&&A&&(null==A?void 0:A.length)>=0?(0,c.jsx)("span",{className:"cib-select-placeholder cib-overflow-ellipsis cib-overflow-hidden cib-first-letter-capitalized cib-text-minor px-2 w-full line-clamp-1 whitespace-normal break-all",children:null===(l=A[0])||void 0===l?void 0:l.label}):A&&(null==A?void 0:A.length)>0?(null==A?void 0:A.length)>1?(0,c.jsxs)("span",{className:"cib-select-placeholder cib-overflow-ellipsis cib-overflow-hidden cib-first-letter-capitalized cib-text-major px-2 w-full flex space-x-2 items-center",children:[(0,c.jsx)("span",{className:"cib-bg-brand-primary cib-text-reverse cib-rounded-full h-4 w-4 text-xs flex items-center justify-center",children:A.length})," ",(0,c.jsx)("span",{className:"line-clamp-1 whitespace-normal break-all",children:"Items selected"})]}):(0,c.jsx)("span",{className:"cib-select-placeholder cib-overflow-ellipsis cib-overflow-hidden cib-first-letter-capitalized cib-text-minor px-2 w-full line-clamp-1 whitespace-normal break-all",children:null===(t=A[0])||void 0===t?void 0:t.label}):(0,c.jsx)("span",{className:"cib-select-placeholder cib-overflow-ellipsis cib-overflow-hidden cib-first-letter-capitalized cib-text-minor px-2 w-full line-clamp-1 whitespace-normal break-all",children:s}),(0,c.jsxs)("div",{className:"flex items-center h-8 -my-1.5",children:[A&&(null==A?void 0:A.length)>0&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("div",{className:"cib-flex cib-justify-center cib-items-center cib-h-full cib-w-8 cib-px-2",onClick:l=>handleClearClick(l,{elementProps:e}),...E,children:(0,c.jsx)("cib-icon",{name:"ic_close",color:"var(--cib-color-brand-primary)",size:"2"})})}),(0,c.jsx)("div",{className:"cib-px-2 cib-z-1 cib-rounded-r-sm cib-flex cib-h-6",...C,children:(0,c.jsx)("div",{className:"cib-svg-container cib-cursor-pointer items-center flex origin-center rotate-0 group-focus-within:rotate-180",children:(0,c.jsx)("cib-icon",{name:"ic_chevron_down",color:"var(--cib-color-gray-700)",size:"2"})})})]})]}),(0,c.jsx)("div",{className:"transition transition-all cib-select-dropdown ".concat(I?"border absolute opacity-0 max-h-0 group-focus-within:max-h-screen group-focus-within:opacity-100":"border-0 static opacity-100 max-h-full"," lg:border cib-border-default lg:absolute z-10 flex flex-col items-center cib-rounded-xs w-full cib-bg-surface overflow-hidden lg:opacity-0 h-auto lg:max-h-0 lg:group-focus-within:max-h-screen lg:group-focus-within:opacity-100"),onClick:e=>{q(!0)},children:(0,c.jsxs)("div",{className:"cib-scrollbar cib-overflow-y-auto cib-w-full cib-max-h-58.5",children:[m&&A&&(null==A?void 0:A.length)>0&&(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"".concat(I?"block":"hidden"," lg:block"),children:[(0,c.jsxs)("ul",{className:"cib-select-ul-dropdown cib-flex cib-flex-col cib-w-full ".concat(I?"py-0":"py-3"," lg:py-0"),...N,children:[(0,c.jsx)("span",{className:"cib-main-font-caption-regular cib-text-minor cib-py-2 cib-pl-2",children:"Selected item(s)"}),A.map((e,l)=>(0,c.jsx)("li",{role:"option","aria-label":e.label,className:"cib-select-li cib-text-primary !h-auto flex-wrap","aria-checked":!0,"aria-selected":!0,children:(0,c.jsx)("cib-checkbox",{value:e.value.toString(),class:"cib-custom-element-class cib-font-open-sans ".concat(I?"py-1.5 pr-2 pl-2":"py-2.75 pr-0 pl-0"," lg:py-1.5 lg:pr-2 lg:pl-2"),checked:!0,onClick:l=>handleSelectedItemSelect(l,e),name:"".concat(o,"--option--").concat(e.value),label:e.label,role:"checkbox"},"".concat(o,"--").concat(e.value,"--option"))},"".concat(o,"--").concat(e.value,"--selected-list")))]}),(0,c.jsx)("div",{className:"w-full h-[1px] cib-bg-gray-500"})]})}),(0,c.jsxs)("ul",{id:"".concat(null==k?void 0:k.id,"-controls"),className:"cib-select-ul-dropdown cib-select-ul-dropdown-options cib-flex cib-flex-col cib-w-full cib-rounded-t-m ".concat(I?"py-0":"py-3"," lg:py-0"),...N,children:[m&&A&&(null==A?void 0:A.length)>0&&(0,c.jsx)("span",{className:"cib-main-font-caption-regular cib-text-minor cib-py-2 cib-pl-2 ".concat(I?"block":"hidden"," lg:block"),children:"List"}),(0,c.jsx)(CIBOptions,{data:F,parentProps:{...e,onSelect:(l,t)=>{let c=!1;if(l.target.closest(".cib-select-li")&&l.target.closest(".cib-select-li").nextSibling){let e=l.target.closest(".cib-select-li").nextSibling.querySelector('[tabindex="0"]');if(e&&e.focus(),!m&&e){var i;null===(i=document.activeElement)||void 0===i||i.blur()}}let a=[...A];if(m){c=null==l?void 0:l.detail[0];let e=a.findIndex(e=>e.value===t.value);e<0?c&&a.push(t):c||a.splice(e,1);let i=[];a.forEach(e=>{i.push(e.value)}),P([...i])}else c=!0,a=[t],P(null==t?void 0:t.value);_([...a]),void 0!==h&&h(l,{elementProps:e,item:t,selected:c,items:[...a]})},value:B},itemProps:S})]})]})})]}),f&&(0,c.jsx)("div",{children:(0,c.jsxs)("div",{className:"cib-flex cib-flex-row cib-pt-1 cib-main-font-body-s-regular",children:[(0,c.jsx)("cib-icon",{name:"ic_filled_error",size:"2","no-hover":!0,"no-active":!0,color:"var(--cib-color-error)",class:"cib-pr-1 cib-custom-element-class cib-font-open-sans"}),(0,c.jsx)("span",{className:"cib-text-danger-strong cib-first-letter-capitalized cib-text-left",children:f})]})})]})})}}}]);